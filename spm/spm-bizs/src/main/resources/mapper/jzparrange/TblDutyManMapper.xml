<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ts.spm.bizs.mapper.jzparrange.TblDutyManMapper">
	<resultMap id="BaseResultMap"
		type="com.ts.spm.bizs.entity.jzparrange.TblDutyMan">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<constructor>
			<arg column="ID" javaType="java.lang.String" jdbcType="VARCHAR" />
			<arg column="USER_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="USER_NAME" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="USER_TYPE" javaType="java.lang.Short"
				jdbcType="DECIMAL" />
			<arg column="DEPART_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="CRT_TIME" javaType="java.util.Date"
				jdbcType="TIMESTAMP" />
			<arg column="CRT_USER_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="CRT_USER_NAME" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="DEL_TIME" javaType="java.util.Date"
				jdbcType="TIMESTAMP" />
			<arg column="DEL_USER_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="DEL_USER_NAME" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="DEL_FLAG" javaType="java.lang.Short"
				jdbcType="DECIMAL" />
			<arg column="TENANT_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
			<arg column="MEMO" javaType="java.lang.String" jdbcType="VARCHAR" />
			<arg column="GROUP_ID" javaType="java.lang.String"
				jdbcType="VARCHAR" />
		</constructor>
	</resultMap>
	<select id="selectGroup" parameterType="Integer"
		resultType="String">
		SELECT
		GROUP_ID
		FROM
		jzp_oper.TBL_DUTY_MAN
		WHERE
		USER_TYPE = #{userType} AND GROUP_ID != ''
		AND DEL_FLAG = 0
		GROUP BY
		GROUP_ID
	</select>
	<select id="selectGroupList" parameterType="String"
		resultType="com.ts.spm.bizs.vo.jzparrange.TblDutyManVo">
		SELECT
		ID AS id,
		USER_ID AS userId,
		USER_NAME AS userName
		FROM
		jzp_oper.TBL_DUTY_MAN
		WHERE
		GROUP_ID =
		#{groupId}
		AND
		USER_TYPE = #{userType}
		AND
		DEL_FLAG = 0
	</select>
	<select id="selectNoGroupList" parameterType="int"
		resultType="com.ts.spm.bizs.vo.jzparrange.TblDutyManVo">
		SELECT
		ID AS id,
		USER_ID AS userId,
		USER_NAME AS userName
		FROM
		jzp_oper.TBL_DUTY_MAN
		WHERE
		GROUP_ID = '' OR GROUP_ID is null
		AND USER_TYPE = #{userType}
		AND
		DEL_FLAG = 0
	</select>
	<update id="updateGroupId" parameterType="String">
		update jzp_oper.TBL_DUTY_MAN set
		GROUP_ID = ''
		where id = #{id}
	</update>
	<update id="updateDelFlag" parameterType="String">
		delete from jzp_oper.TBL_DUTY_MAN
		where id = #{id}
	</update>
	<update id="updateGroupSave" parameterType="String">
		update jzp_oper.TBL_DUTY_MAN
		<set>
			GROUP_ID = #{groupId}
		</set>
		where id = #{id}
	</update>
	<select id="getPersonnelList" parameterType="String"
		resultType="Map">
		SELECT
		bu.id AS "userId",
		bu.username AS "name",
		tbe.NAME AS "userName",
		bu.DEPART_ID "departId",
		tbe.TENANT_ID "tenantId",
		CASE
		bg.CODE
		WHEN 'ZXZBY' THEN
		'2'
		WHEN 'YCZJY' THEN
		'1'
		END as "userType"
		FROM
		SPM_SYS.BASE_USER bu,
		SPM_SYS.TBL_BASE_EMPLOYEE tbe,
		SPM_SYS.base_group bg,
		SPM_SYS.base_group_leader bgl
		WHERE
		bu.EMPLOY_ID = tbe.id
		AND bgl.group_id = bg.id
		AND bgl.user_id = bu.id
		AND bg.CODE IN ( '${userType}' )
	</select>
	<select id="selectGroupName" parameterType="String"
		resultType="String">
		SELECT
			GROUP_ID 
		FROM
			jzp_oper.TBL_DUTY_MAN
		WHERE
			GROUP_ID = '${group}'
	</select>
	<update id="delGroupPerson" parameterType="String">
		update jzp_oper.TBL_DUTY_MAN set
		GROUP_ID = ''
		where USER_ID = #{id}
	</update>
</mapper>